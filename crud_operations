#include<stdio.h>
char filename[] = "output.txt";
 
struct data{
    char name[30];
    int age;
    int id;
};

  void create(){ 
   FILE *fptr;
   fptr =  fopen(filename,"a");
   if(fptr==NULL){
      printf("Error cr\n");
      return;
   }
   fclose(fptr);
  }

  void display(){
   FILE *fptr;
   fptr = fopen(filename,"r");
   if(fptr==NULL){
      printf("Error dp\n");
      return;
   }
   struct data d;
   while(fscanf(fptr,"%s %d %d",d.name,&d.age,&d.id) != EOF){
      printf("%s ",d.name);
      printf("%d ",d.age);
      printf("%d ",d.id);
      printf("\n");
   }
   fclose(fptr);
  }
void add (){
   FILE *fptr;
   fptr = fopen(filename , "a");
   if(fptr==NULL){
      printf("Error ap\n");
      return;
   }
   struct data d;
   printf("Enter name :");
   scanf("%s",d.name);
   printf("Enter age :");
   scanf("%d",&d.age);
   printf("Enter user :");
   scanf("%d",&d.id);
   fprintf(fptr , "%s %d %d \t",d.name,d.age ,d.id);
   fclose(fptr);
}

void update(){
   FILE *fptr , *fpt;
   fptr = fopen(filename , "r");
   if(fptr==NULL){
      printf("Error up\n");
      return;
   }
   struct data d[100];
   int i=0;
   int find;
   int check=0;
   printf("enter user id to find : ");
   scanf("%d",&find);
   while(fscanf(fptr,"%s %d %d",d[i].name,&d[i].age,&d[i].id)!=EOF){
      if(d[i].id==find){
         printf("Enter name :");
         scanf("%s",d[i].name);
         printf("Enter age :");
         scanf("%d",&d[i].age);
         d[i].id = find;
         check=1;
      }
    //   fprintf(fpt,"%s %d %d \t",ch,age,user);
      i++;
   }
   fclose(fptr);
    if(check==0){
      printf("No such user found\n");
   }
   fpt = fopen(filename , "w");
   for(int j=0;j<i;j++){
      fprintf(fpt,"%s %d %d \t",d[j].name,d[j].age,d[j].id);
   }
   fclose(fpt);
} 

void delete(){
   FILE *fptr , *fpt;
   fptr = fopen(filename , "r");
   if(fptr==NULL){
      printf("Error del\n");
      return;
   }
   struct data d[100];
   int i=0;
   int find;
   int check=0;
   printf("enter user id to find : ");
   scanf("%d",&find);
   while(fscanf(fptr,"%s %d %d",d[i].name,&d[i].age,&d[i].id)!=EOF){
      if(d[i].id==find){
        check=1;
        continue;
      }
    //   fprintf(fpt,"%s %d %d \t",ch,age,user);
      i++;
   }
   fclose(fptr);
    if(check==0){
      printf("No such user found\n");
   }
   fpt = fopen(filename , "w");
   for(int j=0;j<i;j++){
      fprintf(fpt,"%s %d %d \t",d[j].name,d[j].age,d[j].id);
   }
   fclose(fpt);
} 

 int main(){
   int b=1,c;
   printf("1 for create \n 2 for add data \n 3 for update data \n 4 for delete data \n 5 for display all data\n 6 for exit \n" );
   while(b){
      printf("\nEnter choice : ");
      scanf("%d",&c);
      switch (c)
      {
      case 1: create();
         break;
      case 2: add();
         break;
      case 3: update();
         break;
      case 4: delete();
         break;
      case 5: display();
         break;         
      case 6: b=0; break;
      default: printf("Wrong choice\n");
      }
   }
   return 0;

 }
 
