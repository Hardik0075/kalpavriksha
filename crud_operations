#include<stdio.h>
#include<stdlib.h>
char filename[] = "output.txt";
 
  void create(){ 
   FILE *fptr;
   fptr =  fopen(filename,"a");
   if(fptr==NULL){
      printf("Error cr\n");
      return;
   }
   fclose(fptr);
  }

  void display(){
   FILE *fptr;
   fptr = fopen(filename,"r");
   if(fptr==NULL){
      printf("Error dp\n");
      return;
   }
   char ch[100];
   int age , user;
   while(fscanf(fptr,"%s %d %d",ch,&age,&user) != EOF){
      printf("%s ",ch);
      printf("%d ",age);
      printf("%d ",user);
      printf("\n");
   }
   fclose(fptr);
  }
void add (){
   FILE *fptr;
   fptr = fopen(filename , "a");
   if(fptr==NULL){
      printf("Error ap\n");
      exit(1);
   }
   char ch[100];
   int age , user;
   printf("Enter name :");
   scanf("%s",ch);
   printf("Enter age :");
   scanf("%d",&age);
   printf("Enter user :");
   scanf("%d",&user);
   fprintf(fptr , "%s %d %d \t",ch,age ,user);
   fclose(fptr);
}

void update(){
   FILE *fptr , *fpt;
   fptr = fopen(filename , "r");
   if(fptr==NULL){
      printf("Error up\n");
      return;
   }
   char ch[100][100];
   int age[100] , user[100];
   int i=0;
//    fpt = fopen("temp.txt" , "w");
   int find;
   int check=0;
   printf("enter user id to find : ");
   scanf("%d",&find);
   while(fscanf(fptr,"%s %d %d",ch[i],&age[i],&user[i])!=EOF){
      if(user[i]==find){
         printf("Enter name :");
         scanf("%s",ch[i]);
         printf("Enter age :");
         scanf("%d",&age[i]);
         user[i] = find;
         check=1;
      }
    //   fprintf(fpt,"%s %d %d \t",ch,age,user);
      i++;
   }
   fclose(fptr);
    if(check==0){
      printf("No such user found\n");
   }
    fpt = fopen(filename , "w");
   for(int j=0;j<i;j++){
      fprintf(fpt,"%s %d %d \t",ch[j],age[j],user[j]);
   }
   fclose(fpt);
} 

void delete(){
   FILE *fptr , *fpt;
   fptr = fopen(filename , "r");
   if(fptr==NULL){
      printf("Error del\n");
      return;
   }
   char ch[100][100];
   int age[100] , user[100];
   int i=0;
   int find;
   int check=0;
   printf("enter user id to find : ");
   scanf("%d",&find);
   while(fscanf(fptr,"%s %d %d",ch[i],&age[i],&user[i])!=EOF){
      if(user[i]==find){
        check=1;
        continue;
      }
    //   fprintf(fpt,"%s %d %d \t",ch,age,user);
      i++;
   }
   fclose(fptr);
    if(check==0){
      printf("No such user found\n");
   }
    fpt = fopen(filename , "w");
   for(int j=0;j<i;j++){
      fprintf(fpt,"%s %d %d \t",ch[j],age[j],user[j]);
   }
   fclose(fpt);
} 

 int main(){
   //  printf("Hello");
   // FILE *fptr;
   create();
   int b=1,c;
   printf("1 for create \n 2 for add data \n 3 for update data \n 4 for delete data \n 5 for display all data\n 6 for exit \n" );
   while(b){
      printf("\nEnter choice : ");
      scanf("%d",&c);
      switch (c)
      {
      case 1: create();
         break;
      case 2: add();
         break;
      case 3: update();
         break;
      case 4: delete();
         break;
      case 5: display();
         break;         
      case 6: b=0; break;
      default: printf("Wrong choice\n");
      }
   }
   return 0;

 }
 
